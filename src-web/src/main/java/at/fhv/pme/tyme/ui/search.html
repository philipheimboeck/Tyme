<!DOCTYPE html>
<html>
<head>
<title>Suche Timetrack</title>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />
</head>
<body>


<h1>Suche Timetrack</h1>

<div class="navigation">
<nav class="navbar navbar-default">
	<div class="container-fluid">
		<!-- Brand and toggle get grouped for better mobile display -->
	    <div class="navbar-header">
	      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
	        <span class="sr-only">Toggle navigation</span>
	        <span class="icon-bar"></span>
	        <span class="icon-bar"></span>
	        <span class="icon-bar"></span>
	      </button>
	      <a class="navbar-brand" href="#">Tyme</a>
	    </div>
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
	      <ul class="nav navbar-nav">



				<li>
				<a href="submit.html">Neuer Track</a>
				</li>

				<li>
				<a href="search.html">Suche</a>
				</li>

				<li>
				<a href="index.html">Alle Tracks</a>
				</li>
		  </ul>
		</div>
	</div>
</nav>

</div>

<div class="content">
	<div id="forms">
		<form method="" action="javascript:;" onsubmit="javascript:submit();">
		<div class="form-group">
			<label for="search">Suchbegriff</label>
			<input class="form-control" type="text" name="search" id="search"/>
		</div>
<br/>
		<div class="form-group">
			<label for="submit">Suchen</label>
			<input class="form-control" type="submit" name="submit" id="submit"/>
		</div>
<br/>
<br/>
<br/>
<br/>
		</form>
	</div>
	


	<table id="table" class="table">
		<thead>
<th>ID</th>
<th>User</th>
<th>Name</th>
<th>Start</th>
<th>Ende</th>
<th>Beschreibung</th>
<th>Aktion</th>
</thead>
		<tbody>
		<!--Start of user code table
		Implement Custom Rows
End of user code-->
		</tbody>
	</table>



</div>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<script type="text/javascript">
$(function() {
	//Start of user code documentLoad
	// TODO: Document Load
	//End of user code
});

function submit() {
	//Start of user code submit
	$.ajax({
		dataType: "json",
		url: "http://localhost:8080/tyme/searchTrack",
		data: {search: encodeURIComponent($('#search').val()) },
		success: function (data) {
			$.each(data, function (idx, val) {
				v = jQuery.parseJSON(val);
				console.log(v);
				$('#table tbody').append('<tr>' +
				'<td>' + v.id + '</td>' +
				'<td>' + v.name + '</td>' +
				'<td>' + v.user + '</td>' +
				'<td>' + v.startStamp + '</td>' +
				'<td>' + v.endStamp + '</td>' +
				'<td>' + v.description + '</td>' +
				'<td><button onclick="deleteTrack('+ v.id + ');" /></td>' +
				'</tr>');
			});
		}
	});
	return false;
	//End of user code
}

function search() {
	//Start of user code search
	//End of user code
}

function deleteTrack(id) {
	//Start of user code deleteTrack
	//	TODO: Implement
	$.ajax({
		dataType: "json",
		url: "http://localhost:8080/tyme/searchTrack",
		data: {search: encodeURIComponent($('#search').val()) },
		url: 'http://localhost:8080/tyme/deleteTrack/'+id,
		type: "DELETE",
		data: null,
		success: function (data) {
			$.each(data, function (idx, val) {
				v = jQuery.parseJSON(val);
				console.log(v);
				$('#table tbody').append('<tr>' +
				'<td>' + v.id + '</td>' +
				'<td>' + v.name + '</td>' +
				'<td>' + v.user + '</td>' +
				'<td>' + v.startStamp + '</td>' +
				'<td>' + v.endStamp + '</td>' +
				'<td>' + v.description + '</td>' +
				'<td><a href="http://localhost:8080/tyme/deleteTrack/' + v.id + '">Delete</a></td>' +
				'</tr>');
			});
			$('#row_'+id).deleteRow();
		}
	});
	return false;
	//End of user code
}

//Start of user code js_code
//	TODO: Implement
//End of user code

</script>

</body>
</html>

