<!DOCTYPE html>
<html>
<head>
<title>Suche Timetrack</title>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<link rel="stylesheet" type="text/css" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />
</head>
<body>


<h1>Suche Timetrack</h1>

<div class="navigation">
<nav>



		<a href="submit.html">Neuer Track</a>

		<a href="search.html">Suche</a>

		<a href="index.html">Alle Tracks</a>

	<!-- Start of user code navigation
	 -->
	<!-- Todo Add custom navigation-->
	<!-- End of user code -->
</nav>

</div>

<div class="content">
	<div id="forms">
		<form method="" onsubmit="return search();">
		<label for="search">Suchbegriff</label>
		<input type="text" name="search" id="search"/>
<br/>
		<label for="submit">Suchen</label>
		<input type="submit" name="submit" id="submit"/>
<br/>
<br/>
<br/>
<br/>
		</form>
	</div>
	


	<table id="table">
		<thead>
<th>ID</th>
<th>User</th>
<th>Name</th>
<th>Start</th>
<th>Ende</th>
<th>Beschreibung</th>
<th>Aktion</th>
</thead>
		<tbody>
		<!--Start of user code table
		Implement Custom Rows
End of user code-->
		</tbody>
	</table>



</div>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<script type="text/javascript">

function submit() {

	//Start of user code submit
	alert("onsubmit");
	console.log("OnSubmit");
	$.ajax({
		dataType: "json",
		url: "http://localhost:8080/tyme/search/" + encodeURIComponent($('#search').val()),
		data: null,
		success: function (data) {
			$.each(data, function (idx, val) {
				v = jQuery.parseJSON(val);
				console.log(v);
				$('#table tbody').append('<tr>' +
				'<td>' + v.id + '</td>' +
				'<td>' + v.name + '</td>' +
				'<td>' + v.user + '</td>' +
				'<td>' + v.startStamp + '</td>' +
				'<td>' + v.endStamp + '</td>' +
				'<td>' + v.description + '</td>' +
				'<td><a href="http://localhost:8080/tyme/deleteTrack/' + v.id + '">Delete</a></td>' +
				'</tr>');
			});
		}
	});
	return false;
	//End of user code

}


function search() {
	//Start of user code search
	$.ajax({
		dataType: "json",
		url: "http://localhost:8080/tyme/searchTrack",
		data: {search: encodeURIComponent($('#search').val()) },
		success: function (data) {
			$.each(data, function (idx, val) {
				v = jQuery.parseJSON(val);
				console.log(v);
				$('#table tbody').append('<tr>' +
				'<td>' + v.id + '</td>' +
				'<td>' + v.name + '</td>' +
				'<td>' + v.user + '</td>' +
				'<td>' + v.startStamp + '</td>' +
				'<td>' + v.endStamp + '</td>' +
				'<td>' + v.description + '</td>' +
				'<td><a href="http://localhost:8080/tyme/deleteTrack/' + v.id + '">Delete</a></td>' +
				'</tr>');
			});
		}
	});
	return false;
	//End of user code
}

function deleteTrack() {
	//Start of user code deleteTrack
	//	TODO: Implement
	console.log("deleteTrack");
	//End of user code
}

//Start of user code submit
$( document ).ready(function() {
	$('form').on('submit',function(){
		search();
		return false;
	});
});
//End of user code

</script>

</body>
</html>

